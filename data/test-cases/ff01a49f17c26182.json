{"uid":"ff01a49f17c26182","name":"Просмотр профиля","fullName":"tests_api.test_view_profile.TestApiProfile#test_view_profile","historyId":"a7d34a5a5395a10d9ef26be14a78ae0c","time":{"start":1721278328198,"stop":1721278328550,"duration":352},"status":"failed","statusMessage":"AssertionError: [{\"type\":\"string_type\",\"loc\":[\"data\",\"city\"],\"msg\":\"Input should be a valid string\",\"input\":null,\"url\":\"https://errors.pydantic.dev/2.3/v/string_type\"}]","statusTrace":"self = <tests_api.utils.asserts.Assertion object at 0x7f9a7f82f1f0>\nscheme = <class 'tests_api.models.profle.UserProfile'>\n\n    def should_actual_scheme(self, scheme):\n        with allure.step(\"Валидация json-схемы\"):\n            try:\n>               scheme.parse_obj(self.actual_value)\n\ntests_api/utils/asserts.py:138: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/dist-packages/typing_extensions.py:2562: in wrapper\n    return __arg(*args, **kwargs)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'tests_api.models.profle.UserProfile'>\nobj = {'data': {'about_myself': None, 'additional_phone': None, 'avatar_url': 'https://storage.yandexcloud.net/pub-test/avatar/48/18-07-2024-04-35-30.jpg', 'city': None, ...}}\n\n    @classmethod\n    @typing_extensions.deprecated(\n        'The `parse_obj` method is deprecated; use `model_validate` instead.', category=PydanticDeprecatedSince20\n    )\n    def parse_obj(cls: type[Model], obj: Any) -> Model:  # noqa: D102\n        warnings.warn('The `parse_obj` method is deprecated; use `model_validate` instead.', DeprecationWarning)\n>       return cls.model_validate(obj)\nE       pydantic_core._pydantic_core.ValidationError: 1 validation error for UserProfile\nE       data.city\nE         Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]\nE           For further information visit https://errors.pydantic.dev/2.3/v/string_type\n\n/usr/local/lib/python3.10/dist-packages/pydantic/main.py:976: ValidationError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <tests_api.test_view_profile.TestApiProfile object at 0x7f9a7f5ce4d0>\nassertion = <class 'tests_api.utils.asserts.Assertion'>\nprofile_api = <tests_api.api.profile.ProfileApi object at 0x7f9a7f82f580>\n\n    @allure.title(\"Просмотр профиля\")\n    @allure.feature(\"[API] UsersProfile\")\n    def test_view_profile(self, assertion, profile_api) -> None:\n        resp = profile_api.user_profile_view(\n            access_token=env_vars.ACCESS_TOKEN,\n        )\n>       assertion(resp.json()).should_actual_scheme(UserProfile)\n\ntests_api/test_view_profile.py:26: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <tests_api.utils.asserts.Assertion object at 0x7f9a7f82f1f0>\nscheme = <class 'tests_api.models.profle.UserProfile'>\n\n    def should_actual_scheme(self, scheme):\n        with allure.step(\"Валидация json-схемы\"):\n            try:\n                scheme.parse_obj(self.actual_value)\n            except ValidationError as e:\n>               assert False, e.json()\nE               AssertionError: [{\"type\":\"string_type\",\"loc\":[\"data\",\"city\"],\"msg\":\"Input should be a valid string\",\"input\":null,\"url\":\"https://errors.pydantic.dev/2.3/v/string_type\"}]\n\ntests_api/utils/asserts.py:140: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1721278318474,"stop":1721278318474,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1721278318474,"stop":1721278318474,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1721278318474,"stop":1721278318474,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1721278318474,"stop":1721278318474,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"_session_faker","time":{"start":1721278318474,"stop":1721278318565,"duration":91},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"assertion","time":{"start":1721278318565,"stop":1721278318565,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"base_url_showcase","time":{"start":1721278318565,"stop":1721278318565,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"playwright","time":{"start":1721278318565,"stop":1721278318926,"duration":361},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"env","time":{"start":1721278318565,"stop":1721278318565,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"browser_type_launch_args","time":{"start":1721278318565,"stop":1721278318565,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"browser_type","time":{"start":1721278318926,"stop":1721278318926,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"browser","time":{"start":1721278318926,"stop":1721278319236,"duration":310},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"launch_browser","time":{"start":1721278318926,"stop":1721278318926,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"device","time":{"start":1721278319237,"stop":1721278319237,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1721278319237,"stop":1721278319237,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"context","time":{"start":1721278328148,"stop":1721278328154,"duration":6},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"page","time":{"start":1721278328154,"stop":1721278328196,"duration":42},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"screenshot_on_failure","time":{"start":1721278328196,"stop":1721278328196,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"profile_api","time":{"start":1721278328197,"stop":1721278328197,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"api_client_showcase","time":{"start":1721278328197,"stop":1721278328197,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: [{\"type\":\"string_type\",\"loc\":[\"data\",\"city\"],\"msg\":\"Input should be a valid string\",\"input\":null,\"url\":\"https://errors.pydantic.dev/2.3/v/string_type\"}]","statusTrace":"self = <tests_api.utils.asserts.Assertion object at 0x7f9a7f82f1f0>\nscheme = <class 'tests_api.models.profle.UserProfile'>\n\n    def should_actual_scheme(self, scheme):\n        with allure.step(\"Валидация json-схемы\"):\n            try:\n>               scheme.parse_obj(self.actual_value)\n\ntests_api/utils/asserts.py:138: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/dist-packages/typing_extensions.py:2562: in wrapper\n    return __arg(*args, **kwargs)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'tests_api.models.profle.UserProfile'>\nobj = {'data': {'about_myself': None, 'additional_phone': None, 'avatar_url': 'https://storage.yandexcloud.net/pub-test/avatar/48/18-07-2024-04-35-30.jpg', 'city': None, ...}}\n\n    @classmethod\n    @typing_extensions.deprecated(\n        'The `parse_obj` method is deprecated; use `model_validate` instead.', category=PydanticDeprecatedSince20\n    )\n    def parse_obj(cls: type[Model], obj: Any) -> Model:  # noqa: D102\n        warnings.warn('The `parse_obj` method is deprecated; use `model_validate` instead.', DeprecationWarning)\n>       return cls.model_validate(obj)\nE       pydantic_core._pydantic_core.ValidationError: 1 validation error for UserProfile\nE       data.city\nE         Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]\nE           For further information visit https://errors.pydantic.dev/2.3/v/string_type\n\n/usr/local/lib/python3.10/dist-packages/pydantic/main.py:976: ValidationError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <tests_api.test_view_profile.TestApiProfile object at 0x7f9a7f5ce4d0>\nassertion = <class 'tests_api.utils.asserts.Assertion'>\nprofile_api = <tests_api.api.profile.ProfileApi object at 0x7f9a7f82f580>\n\n    @allure.title(\"Просмотр профиля\")\n    @allure.feature(\"[API] UsersProfile\")\n    def test_view_profile(self, assertion, profile_api) -> None:\n        resp = profile_api.user_profile_view(\n            access_token=env_vars.ACCESS_TOKEN,\n        )\n>       assertion(resp.json()).should_actual_scheme(UserProfile)\n\ntests_api/test_view_profile.py:26: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <tests_api.utils.asserts.Assertion object at 0x7f9a7f82f1f0>\nscheme = <class 'tests_api.models.profle.UserProfile'>\n\n    def should_actual_scheme(self, scheme):\n        with allure.step(\"Валидация json-схемы\"):\n            try:\n                scheme.parse_obj(self.actual_value)\n            except ValidationError as e:\n>               assert False, e.json()\nE               AssertionError: [{\"type\":\"string_type\",\"loc\":[\"data\",\"city\"],\"msg\":\"Input should be a valid string\",\"input\":null,\"url\":\"https://errors.pydantic.dev/2.3/v/string_type\"}]\n\ntests_api/utils/asserts.py:140: AssertionError","steps":[{"name":"Отправить GET запрос на api/users/profile","time":{"start":1721278328198,"stop":1721278328549,"duration":351},"status":"passed","steps":[{"name":"request","time":{"start":1721278328198,"stop":1721278328549,"duration":351},"status":"passed","steps":[],"attachments":[],"parameters":[{"name":"method","value":"'GET'"},{"name":"url","value":"'https://dev.agentum.pro/backend/api/users/profile'"},{"name":"timeout","value":"5000"},{"name":"params","value":"None"},{"name":"headers","value":"{'Content-type': 'application/json', 'Authorization': 'Bearer YwQogs0aDUHzYIgAIN88OBaTDiKesDmAdciD9vkz'}"}],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":1,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":true,"attachmentStep":false},{"name":"Валидация json-схемы","time":{"start":1721278328549,"stop":1721278328549,"duration":0},"status":"failed","statusMessage":"AssertionError: [{\"type\":\"string_type\",\"loc\":[\"data\",\"city\"],\"msg\":\"Input should be a valid string\",\"input\":null,\"url\":\"https://errors.pydantic.dev/2.3/v/string_type\"}]\n","statusTrace":"  File \"/builds/2uit/Chmaki_autotests/tests_api/utils/asserts.py\", line 140, in should_actual_scheme\n    assert False, e.json()\n","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":true,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":3,"attachmentsCount":0,"shouldDisplayMessage":true,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"screenshot_on_failure::0","time":{"start":1721278328631,"stop":1721278328731,"duration":100},"status":"passed","steps":[],"attachments":[{"uid":"d978d8d824a553e4","name":"screenshot_test_view_profile","source":"d978d8d824a553e4.png","type":"image/png","size":5320}],"parameters":[],"stepsCount":0,"attachmentsCount":1,"shouldDisplayMessage":false,"hasContent":true,"attachmentStep":false},{"name":"api_client_showcase::0","time":{"start":1721278328631,"stop":1721278328631,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"page::0","time":{"start":1721278328732,"stop":1721278328733,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"context::0","time":{"start":1721278328733,"stop":1721278328743,"duration":10},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"browser::0","time":{"start":1721278335076,"stop":1721278335104,"duration":28},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false},{"name":"playwright::0","time":{"start":1721278335109,"stop":1721278335121,"duration":12},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"feature","value":"[API] UsersProfile"},{"name":"parentSuite","value":"Чмаки. API"},{"name":"suite","value":"API тесты"},{"name":"subSuite","value":"API запросы по профилю"},{"name":"tag","value":"api"},{"name":"host","value":"runner-vlhmfsk-project-154-concurrent-0"},{"name":"thread","value":"60-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests_api.test_view_profile"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"browser_name","value":"'chromium'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":["api"]},"source":"ff01a49f17c26182.json","parameterValues":["'chromium'"]}